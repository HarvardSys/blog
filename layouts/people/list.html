{{- define "main" -}}

  <h1 class="mb-14">{{ .Title }}</h1>

{{- $people := .Site.Data.people -}}
{{- $section_order := slice "Directors" "Faculty" "Postdocs" "PhD Students" -}}

{{- range $section_order -}}
  {{- $section_name := . -}}
  {{- $people_in_section := where $people "role" $section_name -}}

  {{- if $people_in_section -}}
    {{- $sortable_people := slice -}}
    {{- range $people_in_section -}}
      {{- $name_parts := split .name " " -}}
      {{- $last_name := index $name_parts (sub (len $name_parts) 1) -}}
      {{- $sortable_people = $sortable_people | append (dict "surname" $last_name "person" .) -}}
    {{- end -}}
    {{- $sorted_people := sort $sortable_people "surname" -}}

    <h2 class="mt-12 mb-8 text-3xl font-bold">{{ $section_name }}</h2>
    <div class="people-grid gap-8">
      {{- range $sorted_people -}}
        {{- with .person -}}
          <div class="p-6">
            {{- if .image -}}
              <img src="{{ .image }}" alt="{{ .name }}" class="w-32 h-32 mx-auto mb-4 people-image">
            {{- else -}}
              <div class="w-32 h-32 rounded-full mx-auto mb-4 flex items-center justify-center people-image people-placeholder" style="background-color: #A51C30;">
                <span class="material-icons-outlined" style="font-size: 64px; color: white;">person</span>
              </div>
            {{- end -}}
            <h3 class="!my-0 pb-1 font-bold !leading-none text-center people-text people-name">
              {{- if .website -}}
                <a href="{{ .website }}" target="_blank" rel="noopener" class="font-bold people-text people-name no-underline hover:underline">{{ .name }}</a>
              {{- else -}}
                {{ .name }}
              {{- end -}}
            </h3>
            {{ if .title }}
              <p class="text-center text-sm prose people-text">{{ .title }}</p>
            {{ end }}
            {{ if .advisor }}
              <p class="text-center text-sm prose people-text">
                {{ if gt (len .advisor) 1 }}Advisors{{ else }}Advisor{{ end }}:
                {{ $num_advisors := len .advisor }}
                {{ $advisor_list := "" }}
                {{ range $i, $advisor := .advisor }}
                  {{- if eq $i 0 -}}
                    {{- $advisor_list = $advisor -}}
                  {{- else if eq (add $i 1) $num_advisors -}}
                    {{- $advisor_list = printf "%s, %s" $advisor_list $advisor -}}
                  {{- else -}}
                    {{- $advisor_list = printf "%s, %s" $advisor_list $advisor -}}
                  {{- end -}}
                {{ end }}
                {{ $advisor_list }}
              </p>
            {{ end }}
            {{ if or .email .website }}
              <p class="text-center text-sm prose people-text people-links">
                {{ if .email }}
                  <a href="mailto:{{ .email }}"><span class="material-icons-outlined prose">email</span></a>
                {{ end }}
                {{ if and .email .website }}
                  &nbsp;
                {{ end }}
                {{ if .website }}
                  <a href="{{ .website }}" target="_blank" rel="noopener"><span class="material-icons-outlined prose">link</span></a>
                {{ end }}
              </p>
            {{ end }}
          </div>
        {{- end -}}
      {{- end -}}
    </div>
  {{- end -}}
{{- end -}}

{{- end -}}
